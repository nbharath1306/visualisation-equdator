<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EQUDATOR // SYSTEM PIPELINE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.js"></script>
    <style>
        :root {
            --bg-color: #030508; /* Deep Void */
            --node-bg: #0f111a;
            --border-dim: #1e293b;
            --accent-cyan: #06b6d4;
            --accent-blue: #3b82f6;
            --accent-purple: #a855f7;
            --accent-pink: #ec4899;
            --accent-green: #10b981;
            --accent-orange: #f59e0b;
        }

        body {
            background-color: var(--bg-color);
            color: #94a3b8;
            font-family: 'JetBrains Mono', monospace;
            overflow: hidden;
            margin: 0; padding: 0;
            user-select: none;
        }

        /* --- BACKGROUND --- */
        .cyber-grid {
            position: fixed; inset: 0; z-index: 0;
            background-image: 
                linear-gradient(rgba(30, 41, 59, 0.2) 1px, transparent 1px),
                linear-gradient(90deg, rgba(30, 41, 59, 0.2) 1px, transparent 1px);
            background-size: 50px 50px;
            mask-image: radial-gradient(circle at 50% 50%, black 40%, transparent 100%);
            animation: pulseGrid 10s ease-in-out infinite alternate;
        }

        @keyframes pulseGrid {
            0% { opacity: 0.3; }
            100% { opacity: 0.6; }
        }

        /* --- NODES (The Chips) --- */
        .node {
            position: absolute;
            background: var(--node-bg);
            border: 1px solid var(--border-dim);
            border-radius: 6px;
            padding: 0;
            width: 200px;
            z-index: 20;
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        }

        .node::before { /* Status Bar */
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
            background: var(--border-dim); transition: background 0.2s;
        }

        .node.active {
            border-color: #cbd5e1;
            transform: scale(1.02);
            box-shadow: 0 0 25px rgba(6, 182, 212, 0.2);
            z-index: 50;
        }

        /* Node Internals */
        .node-header {
            padding: 10px 12px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border-dim);
            background: rgba(255,255,255,0.01);
        }
        .node-content { padding: 12px; }

        /* Type Specific Colors (Hover & Active) */
        .type-market.active { border-color: var(--accent-blue); } .type-market.active::before { background: var(--accent-blue); }
        .type-news.active { border-color: var(--accent-purple); } .type-news.active::before { background: var(--accent-purple); }
        .type-model.active { border-color: var(--accent-cyan); } .type-model.active::before { background: var(--accent-cyan); }
        .type-out.active { border-color: var(--accent-green); } .type-out.active::before { background: var(--accent-green); }

        /* --- PIPES (SVG Layer) --- */
        #pipeline-svg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; pointer-events: none; overflow: visible;
        }

        .pipe-bg {
            fill: none; stroke: #1e293b; stroke-width: 2;
        }
        
        .pipe-flow {
            fill: none; stroke-width: 2; stroke-linecap: round;
            stroke-dasharray: 8 16; /* Short dash, long gap */
            animation: flow 1s linear infinite;
            opacity: 0.15; /* Always visible but dim */
            transition: opacity 0.2s, stroke-width 0.2s;
        }

        /* The "Surge" Effect */
        .pipe-flow.surge {
            opacity: 1;
            stroke-width: 3;
            filter: drop-shadow(0 0 6px currentColor);
        }

        @keyframes flow { to { stroke-dashoffset: -24; } }

        /* --- FUSION CORE ANIMATION --- */
        @keyframes heartbeat {
            0% { box-shadow: 0 0 0 0 rgba(6, 182, 212, 0.4); transform: scale(1); }
            50% { box-shadow: 0 0 20px 10px rgba(6, 182, 212, 0); transform: scale(1.02); }
            100% { box-shadow: 0 0 0 0 rgba(6, 182, 212, 0); transform: scale(1); }
        }
        .fusion-core { animation: heartbeat 3s infinite; }
        .fusion-core.fast { animation: heartbeat 0.8s infinite; }

    </style>
</head>
<body class="w-screen h-screen flex flex-col">

    <div class="cyber-grid"></div>

    <!-- HUD Header -->
    <div class="fixed top-0 w-full h-14 bg-[#030508]/90 backdrop-blur-md border-b border-[#1e293b] flex items-center justify-between px-8 z-50">
        <div class="flex items-center gap-4">
            <div class="w-8 h-8 rounded bg-cyan-500/10 border border-cyan-500/30 flex items-center justify-center">
                <i data-lucide="cpu" class="w-4 h-4 text-cyan-400"></i>
            </div>
            <div>
                <h1 class="text-sm font-bold text-white tracking-widest">EQUDATOR <span class="text-slate-600">//</span> ARCHITECTURE</h1>
                <div class="text-[9px] text-slate-500 font-mono">HYBRID GNN-LSTM PIPELINE</div>
            </div>
        </div>
        <div class="flex gap-6 text-[10px] font-mono">
            <div class="flex items-center gap-2 text-slate-400">
                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span> SYSTEM LIVE
            </div>
            <div id="activity-log" class="text-cyan-400 opacity-0 transition-opacity duration-500">
                PROCESSING BATCH #<span id="batch-id">294</span>...
            </div>
        </div>
    </div>

    <!-- CANVAS WRAPPER -->
    <div id="viewport" class="flex-1 overflow-auto relative cursor-grab active:cursor-grabbing">
        <div id="canvas" class="relative w-[1800px] h-[900px] mt-10 ml-20 scale-95 origin-top-left">
            
            <!-- SVG LAYER -->
            <svg id="pipeline-svg"></svg>

            <!-- =========================
                 ZONE 1: DATA INGESTION
            ========================= -->
            <div class="absolute top-[50px] left-[50px] text-[10px] tracking-widest text-slate-600 font-bold">01 / INGESTION</div>

            <div id="node-market" class="node type-market" style="top: 100px; left: 50px;">
                <div class="node-header"><span class="text-[9px] text-slate-500">SRC_01</span><i data-lucide="candlestick-chart" class="w-3 h-3 text-blue-500"></i></div>
                <div class="node-content">
                    <div class="font-bold text-white text-[13px] mb-1">Market API</div>
                    <div class="text-[9px] text-slate-500 font-mono">OHLCV Stream (NSE)</div>
                </div>
            </div>

            <div id="node-synth" class="node type-synth" style="top: 280px; left: 50px;">
                <div class="node-header"><span class="text-[9px] text-slate-500">SRC_02</span><i data-lucide="flask-conical" class="w-3 h-3 text-pink-500"></i></div>
                <div class="node-content">
                    <div class="font-bold text-white text-[13px] mb-1">Synthetic Gen</div>
                    <div class="text-[9px] text-slate-500 font-mono">Pattern Injection</div>
                </div>
            </div>

            <div id="node-rss" class="node type-news" style="top: 550px; left: 50px;">
                <div class="node-header"><span class="text-[9px] text-slate-500">SRC_03</span><i data-lucide="rss" class="w-3 h-3 text-purple-500"></i></div>
                <div class="node-content">
                    <div class="font-bold text-white text-[13px] mb-1">News Feeds</div>
                    <div class="text-[9px] text-slate-500 font-mono">Unstructured Text</div>
                </div>
            </div>

            <!-- =========================
                 ZONE 2: PRE-PROCESSING
            ========================= -->
            <div class="absolute top-[50px] left-[350px] text-[10px] tracking-widest text-slate-600 font-bold">02 / TRANSFORM</div>

            <div id="node-tech" class="node" style="top: 150px; left: 350px;">
                <div class="node-header"><span class="text-[9px] text-slate-500">COMPUTE</span></div>
                <div class="node-content">
                    <div class="font-bold text-white text-[13px] mb-2">Tech Indicators</div>
                    <div class="flex gap-2">
                        <span class="px-1.5 py-0.5 bg-slate-800 rounded text-[9px] text-blue-300 border border-blue-900">RSI</span>
                        <span class="px-1.5 py-0.5 bg-slate-800 rounded text-[9px] text-blue-300 border border-blue-900">MACD</span>
                    </div>
                </div>
            </div>

            <div id="node-embed" class="node" style="top: 550px; left: 350px;">
                <div class="node-header"><span class="text-[9px] text-slate-500">NLP_PROC</span></div>
                <div class="node-content">
                    <div class="font-bold text-white text-[13px] mb-2">Embeddings</div>
                    <div class="h-1.5 w-full bg-slate-800 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-500 w-[60%]"></div>
                    </div>
                    <div class="text-[9px] text-right text-purple-400 mt-1">Vec: [384]</div>
                </div>
            </div>

            <!-- =========================
                 ZONE 3: MODELS
            ========================= -->
            <div class="absolute top-[50px] left-[650px] text-[10px] tracking-widest text-slate-600 font-bold">03 / NEURAL CORE</div>

            <div id="node-lstm" class="node type-model" style="top: 100px; left: 650px; height: 140px;">
                <div class="node-header"><span class="text-[9px] text-blue-400">TEMPORAL</span></div>
                <div class="node-content">
                    <div class="font-bold text-white text-lg mb-1">LSTM</div>
                    <div class="text-[9px] text-slate-500">Sequential Logic (60d)</div>
                    <!-- Mini Viz -->
                    <div class="flex gap-1 mt-4 h-4 items-end">
                        <div class="w-1 bg-blue-600 h-2"></div><div class="w-1 bg-blue-600 h-3"></div><div class="w-1 bg-blue-600 h-4"></div><div class="w-1 bg-blue-400 h-full animate-pulse"></div>
                    </div>
                </div>
            </div>

            <div id="node-graph" class="node" style="top: 360px; left: 650px;">
                <div class="node-header"><span class="text-[9px] text-slate-500">STRUCTURAL</span></div>
                <div class="node-content">
                    <div class="font-bold text-white text-[13px] mb-1">Graph Construct</div>
                    <div class="text-[9px] text-slate-500 mb-2">Adjacency Matrix</div>
                    <i data-lucide="share-2" class="w-4 h-4 text-slate-600 mx-auto"></i>
                </div>
            </div>

            <div id="node-gnn" class="node type-model" style="top: 550px; left: 900px;">
                <div class="node-header"><span class="text-[9px] text-purple-400">SPATIAL</span></div>
                <div class="node-content">
                    <div class="font-bold text-white text-lg mb-1">GNN</div>
                    <div class="text-[9px] text-slate-500">Graph Attention (GAT)</div>
                </div>
            </div>

            <!-- =========================
                 ZONE 4: FUSION
            ========================= -->
            
            <div id="node-fusion" class="node fusion-core type-model" style="top: 320px; left: 1150px; width: 140px; height: 140px; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; border-color: var(--accent-cyan); background: rgba(6,182,212,0.05);">
                <div class="text-[9px] text-cyan-400 mb-1 tracking-widest">CONCAT</div>
                <div class="text-xl font-black text-white tracking-tighter">FUSION</div>
                <div class="text-[9px] text-slate-500 mt-1">DENSE LAYER</div>
            </div>

            <!-- Dense Output Layer -->
            <div id="node-dense" class="node" style="top: 340px; left: 1350px; width: 120px; height: 100px;">
                <div class="node-header"><span class="text-[9px] text-slate-500">LAYER</span></div>
                <div class="node-content text-center">
                    <div class="font-bold text-white text-xs">Dropout</div>
                    <div class="font-bold text-white text-xs">ReLU</div>
                </div>
            </div>

            <!-- =========================
                 ZONE 5: INFERENCE
            ========================= -->
            <div class="absolute top-[50px] left-[1550px] text-[10px] tracking-widest text-slate-600 font-bold">04 / OUTPUT</div>

            <div id="node-price" class="node type-out" style="top: 220px; left: 1550px;">
                <div class="node-header"><span class="text-[9px] text-green-400">TARGET</span></div>
                <div class="node-content text-center">
                    <div class="text-3xl font-bold text-white tracking-tighter">â‚¹2450</div>
                    <div class="text-[9px] text-green-400 mt-1">PREDICTED CLOSE</div>
                </div>
            </div>

            <div id="node-risk" class="node type-out" style="top: 450px; left: 1550px; border-top: 3px solid #f59e0b;">
                <div class="node-header"><span class="text-[9px] text-orange-400">RISK</span></div>
                <div class="node-content text-center">
                    <div class="text-3xl font-bold text-white tracking-tighter">1:3.2</div>
                    <div class="text-[9px] text-orange-400 mt-1">RRR SCORE</div>
                </div>
            </div>

        </div>
    </div>

    <script>
        lucide.createIcons();

        // --- CONNECTOR ENGINE ---
        // Draws precise lines between DOM elements
        function connectNodes(id1, id2, color = '#334155') {
            const svg = document.getElementById('pipeline-svg');
            const n1 = document.getElementById(id1);
            const n2 = document.getElementById(id2);

            if (!n1 || !n2) return;

            // Geometry
            const r1 = n1.getBoundingClientRect();
            const r2 = n2.getBoundingClientRect();
            const c = document.getElementById('canvas').getBoundingClientRect();

            // Port Calculation (Right of Src -> Left of Dest)
            const x1 = r1.right - c.left;
            const y1 = r1.top + r1.height/2 - c.top;
            const x2 = r2.left - c.left;
            const y2 = r2.top + r2.height/2 - c.top;

            // Elbow Logic
            const midX = x1 + (x2 - x1) / 2;
            const pathData = `M ${x1} ${y1} L ${midX} ${y1} L ${midX} ${y2} L ${x2} ${y2}`;

            // 1. Background Pipe
            const pipe = document.createElementNS("http://www.w3.org/2000/svg", "path");
            pipe.setAttribute("d", pathData);
            pipe.setAttribute("class", "pipe-bg");
            svg.appendChild(pipe);

            // 2. Flow Stream (Animated)
            const flow = document.createElementNS("http://www.w3.org/2000/svg", "path");
            flow.setAttribute("d", pathData);
            flow.setAttribute("class", "pipe-flow");
            flow.setAttribute("id", `flow-${id1}-${id2}`); // ID for targeting
            flow.style.stroke = color;
            svg.appendChild(flow);
        }

        function drawSystem() {
            document.getElementById('pipeline-svg').innerHTML = ''; // Reset

            // --- WIRING THE WHITEBOARD ---
            
            // PATH A: MARKET (Blue)
            connectNodes('node-market', 'node-tech', '#3b82f6');
            connectNodes('node-synth', 'node-tech', '#ec4899');
            connectNodes('node-tech', 'node-lstm', '#3b82f6');
            connectNodes('node-lstm', 'node-fusion', '#3b82f6');
            // Correlation Link
            connectNodes('node-market', 'node-graph', '#3b82f6'); 

            // PATH B: NEWS (Purple)
            connectNodes('node-rss', 'node-embed', '#a855f7');
            connectNodes('node-embed', 'node-graph', '#a855f7');
            connectNodes('node-graph', 'node-gnn', '#a855f7');
            connectNodes('node-gnn', 'node-fusion', '#a855f7');

            // PATH C: OUTPUT (Green)
            connectNodes('node-fusion', 'node-dense', '#22d3ee');
            connectNodes('node-dense', 'node-price', '#22c55e');
            connectNodes('node-dense', 'node-risk', '#f59e0b');
        }

        // --- AUTONOMOUS TRAFFIC SIMULATOR ---
        // Makes the system "breathe" by firing random data packets
        function simulateTraffic() {
            const paths = [
                ['node-market', 'node-tech'],
                ['node-tech', 'node-lstm'],
                ['node-lstm', 'node-fusion'],
                ['node-rss', 'node-embed'],
                ['node-embed', 'node-graph'],
                ['node-graph', 'node-gnn'],
                ['node-gnn', 'node-fusion'],
                ['node-fusion', 'node-dense'],
                ['node-dense', 'node-price']
            ];

            // Randomly pick a path to surge
            const path = paths[Math.floor(Math.random() * paths.length)];
            const flowId = `flow-${path[0]}-${path[1]}`;
            const flowEl = document.getElementById(flowId);
            const nodeEl = document.getElementById(path[1]); // The destination node

            if (flowEl && nodeEl) {
                // 1. Surge the line
                flowEl.classList.add('surge');
                
                // 2. Activate the destination node briefly
                setTimeout(() => {
                    nodeEl.classList.add('active');
                    // If hitting fusion, speed up heartbeat
                    if (path[1] === 'node-fusion') document.getElementById('node-fusion').classList.add('fast');
                }, 500);

                // 3. Reset
                setTimeout(() => {
                    flowEl.classList.remove('surge');
                    nodeEl.classList.remove('active');
                    if (path[1] === 'node-fusion') document.getElementById('node-fusion').classList.remove('fast');
                }, 1500);
            }

            // Update Header Log
            const batchId = Math.floor(Math.random() * 900) + 100;
            document.getElementById('batch-id').innerText = batchId;
            document.getElementById('activity-log').style.opacity = '1';
            setTimeout(() => document.getElementById('activity-log').style.opacity = '0.5', 200);
        }

        // Init
        window.addEventListener('load', () => {
            setTimeout(drawSystem, 100);
            // Start the "Heartbeat"
            setInterval(simulateTraffic, 800); 
        });
        window.addEventListener('resize', drawSystem);

    </script>
</body>
</html>
