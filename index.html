<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EQUDATOR // SYSTEM PIPELINE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.js"></script>
    <style>
        :root {
            --bg-color: #0d1117;
            --node-bg: #161b22;
            --border-color: #30363d;
            --accent-blue: #58a6ff;   
            --accent-purple: #bc8cff; 
            --accent-green: #3fb950;   
            --accent-orange: #d29922;      
            --accent-pink: #f472b6;
        }

        body {
            background-color: var(--bg-color);
            color: #c9d1d9;
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            margin: 0; padding: 0;
        }

        /* --- Eraser.io Style Grid --- */
        .blueprint-grid {
            position: fixed; inset: 0; z-index: 0;
            background-image: 
                linear-gradient(#21262d 1px, transparent 1px),
                linear-gradient(90deg, #21262d 1px, transparent 1px);
            background-size: 20px 20px;
            opacity: 0.3;
        }

        /* --- Engineering Nodes --- */
        .node {
            position: absolute;
            background: var(--node-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            width: 220px;
            z-index: 20;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            user-select: none;
        }

        .node:hover {
            border-color: #c9d1d9;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transform: translateY(-2px);
            z-index: 50;
        }

        .node-header {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #8b949e;
            margin-bottom: 8px;
            display: flex; justify-content: space-between; align-items: center;
        }

        .node-title {
            font-weight: 700;
            font-size: 14px;
            color: #f0f6fc;
            margin-bottom: 4px;
        }

        .node-meta {
            font-size: 11px;
            color: #8b949e;
            background: rgba(255,255,255,0.03);
            padding: 4px 8px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            margin-top: 8px;
        }

        /* Specialized Borders */
        .source-market { border-left: 3px solid var(--accent-blue); }
        .source-news { border-left: 3px solid var(--accent-purple); }
        .source-synth { border-left: 3px solid var(--accent-pink); }
        .proc { border-top: 3px solid #8b949e; }
        .model-lstm { border: 1px solid var(--accent-blue); box-shadow: 0 0 15px rgba(88, 166, 255, 0.1); }
        .model-gnn { border: 1px solid var(--accent-purple); box-shadow: 0 0 15px rgba(188, 140, 255, 0.1); }
        .fusion { border: 2px solid #fff; background: #21262d; }
        .output { border-top: 3px solid var(--accent-green); }

        /* --- Connection Layer --- */
        #svg-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; pointer-events: none; overflow: visible;
        }

        .connector-bg {
            fill: none;
            stroke: #30363d;
            stroke-width: 3;
            stroke-linejoin: round;
        }

        .connector-flow {
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-dasharray: 10 10;
            animation: flow 1s linear infinite;
        }
        
        .flow-blue { stroke: var(--accent-blue); }
        .flow-purple { stroke: var(--accent-purple); animation-duration: 1.5s; }
        .flow-green { stroke: var(--accent-success); stroke-width: 3; }
        .flow-pink { stroke: var(--accent-pink); stroke-dasharray: 5 5; animation-duration: 2s; }
        
        .connector-dash {
            fill: none;
            stroke: #484f58;
            stroke-width: 1.5;
            stroke-dasharray: 4 4;
            opacity: 0.5;
        }

        @keyframes flow {
            to { stroke-dashoffset: -20; }
        }

        /* --- Labels --- */
        .group-label {
            position: absolute;
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: #484f58;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            transform: rotate(-90deg);
            transform-origin: left bottom;
        }

    </style>
</head>
<body>

    <div class="blueprint-grid"></div>

    <!-- Header UI -->
    <div class="fixed top-0 left-0 w-full h-14 bg-[#0d1117]/95 border-b border-[#30363d] flex items-center px-8 z-50 justify-between backdrop-blur">
        <div class="flex items-center gap-4">
            <div class="w-8 h-8 bg-blue-500/10 border border-blue-500/30 rounded flex items-center justify-center">
                <i data-lucide="cpu" class="w-5 h-5 text-blue-400"></i>
            </div>
            <div>
                <h1 class="text-sm font-bold text-white tracking-widest">EQUDATOR <span class="text-slate-500">///</span> SYSTEM MAP</h1>
                <div class="text-[10px] font-mono text-slate-500">HYBRID GNN-LSTM PIPELINE v2.0</div>
            </div>
        </div>
        <div class="flex gap-6 font-mono text-[10px]">
            <div class="flex items-center gap-2 text-slate-400"><span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span> SYSTEM ONLINE</div>
            <div class="text-blue-400">MARKET DATA: CONNECTED</div>
            <div class="text-purple-400">SENTIMENT: CONNECTED</div>
        </div>
    </div>

    <!-- MAIN CANVAS -->
    <div id="canvas-container" class="relative w-[1800px] h-[900px] mt-14 ml-10 scale-90 origin-top-left">
        
        <!-- SVG Connections Layer -->
        <svg id="svg-layer">
            <defs>
                <marker id="arrow" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0,0 L8,4 L0,8 z" fill="#30363d"/></marker>
                <marker id="arrow-blue" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0,0 L8,4 L0,8 z" fill="#58a6ff"/></marker>
                <marker id="arrow-purple" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0,0 L8,4 L0,8 z" fill="#bc8cff"/></marker>
            </defs>
        </svg>

        <!-- === ZONE 1: INGESTION === -->
        <div class="absolute left-0 top-[100px] h-[600px] border-l border-slate-800"></div>
        <div class="group-label" style="left: -15px; top: 350px;">Data Ingestion</div>

        <!-- Node: Market Data -->
        <div id="market" class="node source-market" style="top: 100px; left: 50px;">
            <div class="node-header text-blue-400"><span>SRC_01</span><i data-lucide="candlestick-chart" class="w-4 h-4"></i></div>
            <div class="node-title">Market API</div>
            <div class="node-meta">Real-time OHLCV</div>
            <div class="mt-2 text-[10px] text-slate-500 font-mono">NSE / BSE Stream</div>
        </div>

        <!-- Node: Synthetic -->
        <div id="synth" class="node source-synth" style="top: 280px; left: 50px;">
            <div class="node-header text-pink-400"><span>SRC_02</span><i data-lucide="box" class="w-4 h-4"></i></div>
            <div class="node-title">Synthetic Gen</div>
            <div class="node-meta">Pattern Injection</div>
            <div class="mt-2 text-[10px] text-slate-500 font-mono">"Head & Shoulders"</div>
        </div>

        <!-- Node: RSS -->
        <div id="rss" class="node source-news" style="top: 550px; left: 50px;">
            <div class="node-header text-purple-400"><span>SRC_03</span><i data-lucide="rss" class="w-4 h-4"></i></div>
            <div class="node-title">News Feeds</div>
            <div class="node-meta">Unstructured Text</div>
            <div class="mt-2 text-[10px] text-slate-500 font-mono">MoneyControl / ET</div>
        </div>


        <!-- === ZONE 2: FEATURE ENGINEERING === -->

        <!-- Node: Tech Indicators -->
        <div id="tech" class="node proc" style="top: 150px; left: 350px;">
            <div class="node-header"><span>TRANSFORM</span></div>
            <div class="node-title">Tech Indicators</div>
            <div class="flex gap-2 mt-2">
                <span class="px-2 py-1 bg-slate-800 rounded text-[9px] text-blue-300">RSI</span>
                <span class="px-2 py-1 bg-slate-800 rounded text-[9px] text-blue-300">MACD</span>
            </div>
        </div>

        <!-- Node: Embeddings -->
        <div id="embed" class="node proc" style="top: 550px; left: 350px;">
            <div class="node-header"><span>NLP CORE</span></div>
            <div class="node-title">Embeddings</div>
            <div class="node-meta">SentenceTransformer</div>
            <div class="mt-2 h-1.5 w-full bg-slate-800 rounded-full overflow-hidden"><div class="h-full bg-purple-500 w-3/4 animate-pulse"></div></div>
        </div>


        <!-- === ZONE 3: MODELS & STRUCTURE === -->
        <div class="absolute left-[600px] top-[100px] h-[600px] border-l border-slate-800"></div>

        <!-- Node: LSTM (Top) -->
        <div id="lstm" class="node model-lstm" style="top: 100px; left: 650px; height: 140px;">
            <div class="node-header text-blue-400"><span>TEMPORAL</span></div>
            <div class="node-title text-xl">LSTM Network</div>
            <div class="node-meta">Sequence: 60 Days</div>
            <div class="mt-3 flex gap-1">
                <div class="h-3 w-3 bg-blue-900 rounded-sm"></div><div class="h-3 w-3 bg-blue-800 rounded-sm"></div><div class="h-3 w-3 bg-blue-600 rounded-sm"></div><div class="h-3 w-3 bg-blue-500 rounded-sm animate-pulse"></div>
            </div>
        </div>

        <!-- Node: Graph Construction (Middle) - THE WHITEBOARD KEY -->
        <div id="graph" class="node proc" style="top: 350px; left: 650px;">
            <div class="node-header"><span>STRUCTURAL</span></div>
            <div class="node-title">Graph Gen</div>
            <div class="node-meta">Adjacency Matrix</div>
            <div class="mt-2 text-[9px] text-slate-500">Price Correlation + Semantic Link</div>
        </div>

        <!-- Node: GNN (Bottom) -->
        <div id="gnn" class="node model-gnn" style="top: 550px; left: 650px; height: 140px;">
            <div class="node-header text-purple-400"><span>RELATIONAL</span></div>
            <div class="node-title text-xl">GNN Model</div>
            <div class="node-meta">Graph Attention (GAT)</div>
            <div class="mt-3 relative h-8">
                <svg class="absolute inset-0 w-full h-full stroke-purple-500/50"><circle cx="10" cy="10" r="3" fill="#a855f7"/><circle cx="50" cy="20" r="3" fill="#a855f7"/><line x1="10" y1="10" x2="50" y2="20"/></svg>
            </div>
        </div>


        <!-- === ZONE 4: FUSION === -->

        <!-- Node: Fusion -->
        <div id="fusion" class="node fusion" style="top: 320px; left: 950px; width: 160px; height: 160px; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;">
            <div class="w-12 h-12 rounded-full border-4 border-slate-700 border-t-white animate-spin mb-2"></div>
            <div class="node-title text-xl">FUSION</div>
            <div class="text-[10px] text-slate-400 font-mono">CONCATENATE</div>
        </div>


        <!-- === ZONE 5: OUTPUT === -->
        
        <!-- Node: Dense -->
        <div id="dense" class="node" style="top: 340px; left: 1200px; width: 140px;">
            <div class="node-header"><span>LAYER</span></div>
            <div class="node-title text-sm">Dense/Dropout</div>
        </div>

        <!-- Outputs -->
        <div id="out-price" class="node output" style="top: 220px; left: 1400px;">
            <div class="node-header text-green-400"><span>TARGET</span></div>
            <div class="node-title text-2xl">â‚¹2450.50</div>
            <div class="node-meta">Next Close</div>
        </div>

        <div id="out-risk" class="node output border-t-orange-500" style="top: 480px; left: 1400px;">
            <div class="node-header text-orange-400"><span>RISK</span></div>
            <div class="node-title text-2xl">1:3.2</div>
            <div class="node-meta">RRR Score</div>
        </div>

    </div>

    <!-- Initialization Script -->
    <script>
        lucide.createIcons();

        // --- THE CONNECTOR ENGINE ---
        function drawConnection(startId, endId, style = 'blue', type = 'flow') {
            const svg = document.getElementById('svg-layer');
            const start = document.getElementById(startId);
            const end = document.getElementById(endId);
            
            if (!start || !end) return;

            const startRect = start.getBoundingClientRect();
            const endRect = end.getBoundingClientRect();
            const containerRect = document.getElementById('canvas-container').getBoundingClientRect();

            // Coordinate Calculation relative to container
            const x1 = startRect.right - containerRect.left;
            const y1 = startRect.top + (startRect.height / 2) - containerRect.top;
            const x2 = endRect.left - containerRect.left;
            const y2 = endRect.top + (endRect.height / 2) - containerRect.top;

            // Orthogonal Routing Logic (Elbows)
            const midX = x1 + (x2 - x1) / 2;
            let d = `M ${x1} ${y1} L ${midX} ${y1} L ${midX} ${y2} L ${x2} ${y2}`;

            // Create Background Path (The "Wire")
            const bgPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
            bgPath.setAttribute("d", d);
            bgPath.setAttribute("class", "connector-bg");
            svg.appendChild(bgPath);

            // Create Flow Path (The "Data")
            if (type === 'flow') {
                const flowPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
                flowPath.setAttribute("d", d);
                flowPath.setAttribute("class", `connector-flow flow-${style}`);
                svg.appendChild(flowPath);
            } else if (type === 'dash') {
                const dashPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
                dashPath.setAttribute("d", d);
                dashPath.setAttribute("class", "connector-dash");
                svg.appendChild(dashPath);
            }
        }

        function renderDiagram() {
            const svg = document.getElementById('svg-layer');
            svg.innerHTML = ''; // Clear existing lines

            // --- 1. MARKET DATA PATH (Blue) ---
            drawConnection('market', 'tech', 'blue');
            drawConnection('synth', 'tech', 'pink');
            drawConnection('tech', 'lstm', 'blue');
            drawConnection('lstm', 'fusion', 'blue');

            // --- 2. NEWS DATA PATH (Purple) ---
            drawConnection('rss', 'embed', 'purple');
            drawConnection('embed', 'graph', 'purple');
            drawConnection('graph', 'gnn', 'purple');
            drawConnection('gnn', 'fusion', 'purple');

            // --- 3. CORRELATION LINK (Whiteboard Detail) ---
            // Market data also feeds graph construction
            drawConnection('market', 'graph', 'blue', 'dash');

            // --- 4. OUTPUT PATH (Green) ---
            drawConnection('fusion', 'dense', 'green');
            drawConnection('dense', 'out-price', 'green');
            drawConnection('dense', 'out-risk', 'green');
        }

        // Initialize and handle resize
        window.addEventListener('load', renderDiagram);
        window.addEventListener('resize', renderDiagram);
        
        // Safety timeout to ensure fonts load
        setTimeout(renderDiagram, 500);

    </script>
</body>
</html>
